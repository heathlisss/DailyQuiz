# DailyQuiz

DailyQuiz — это мобильное Android-приложение для прохождения ежедневных викторин. Пользователь может проверить свои знания, ответив на 5 вопросов из различных категорий, и отслеживать свой прогресс в истории прохождений. Проект служит демонстрацией применения современных технологий и архитектурных подходов в Android-разработке.

## Функционал

-   **Запуск и прохождение викторины**:
    -   Возможность начать новую викторину или повторить одну из пройденных.
    -   Вопросы и варианты ответов загружаются из внешнего API.
    -   Интерактивный выбор ответа с блокировкой кнопки "Далее" до момента выбора.
    -   Возможность отменить выбор ответа повторным нажатием.
    -   Динамическая смена текста на кнопке на последнем вопросе.
-   **Экран результатов**:
    -   Отображение итогового счета с текстовой оценкой и рейтингом в виде звезд.
    -   **Интерактивный разбор ответов**: по клику на карточку результатов динамически подгружается и отображается полный список вопросов с указанием правильного и выбранного пользователем ответа.
    -   Возможность пройти этот же тест заново или начать новый квиз со случайными вопросами.
-   **История прохождений**:
    -   Отображение списка всех завершенных викторин, отсортированных по дате.
    -   Для каждой попытки выводится результат, дата и время.
    -   Реализовано "пустое состояние" (Empty State) с призывом к действию, если история пуста.
    -   Переход к разбору ответов по клику на любой элемент истории.

---

## Техническая реализация

### Архитектура
Проект построен на основе многослойной архитектуры **MVVM (Model-View-ViewModel)** с применением принципов **Clean Architecture**. Такое разделение обеспечивает слабую связанность компонентов, упрощает тестирование и дальнейшую поддержку кода.

-   **UI Layer (`ui`)**: Полностью реализован на **Jetpack Compose**. Экраны (`*Screen.kt`) являются stateless Composable-функциями, которые получают состояние от ViewModel и передают ей события пользователя. Навигация между экранами управляется **Jetpack Navigation for Compose**.
-   **ViewModel Layer (`viewmodel`)**: `QuizViewModel`, `ResultsViewModel`, `HistoryViewModel` отвечают за бизнес-логику и управление состоянием UI. Они используют **Kotlin Coroutines** для асинхронных операций и **StateFlow** для предоставления реактивного потока данных в UI. Состояние каждого экрана моделируется через `data class`, а действия пользователя — через `sealed interface` событий.
-   **Data Layer (`data`)**:
    -   **Repository (`QuizRepository.kt`)**: Реализует паттерн "Репозиторий" и служит единой точкой доступа к данным для ViewModel. Он инкапсулирует логику выбора источника данных — удаленного (сеть) или локального (база данных).
    -   **Data Sources**:
        -   **Remote**: Использует **Retrofit 2** для выполнения HTTP-запросов к API Open Trivia DB. **Moshi** применяется для десериализации JSON-ответов в сетевые DTO-модели.
        -   **Local**: Использует **Room** для работы с локальной базой данных SQLite. `QuizDao` определяет интерфейс для всех CRUD-операций. Связи между таблицами (одна попытка -> много вопросов) реализованы через `@Relation`.
    -   **Models**: В проекте используется маппинг между тремя типами моделей:
        1.  **Network DTOs** (`ApiQuestion`) — для парсинга JSON.
        2.  **Database Entities** (`QuizAttemptEntity`) — для хранения в Room.
        3.  **Domain Models** (`Question`, `QuizReview`) — чистые Kotlin-классы для использования в UI и бизнес-логике.

### Внедрение зависимостей
Для управления зависимостями используется **Koin**. В файле `di/AppModule.kt` определены инструкции по созданию всех основных компонентов: `single` для синглтонов (репозиторий, DAO, Retrofit-клиент) и `viewModel` для фабрик ViewModel.

### Обработка состояний UI
Состояние каждого экрана представлено в виде `StateFlow<*State>`, где `*State` — это `data class`. Это позволяет UI быть полностью реактивным и автоматически обновляться при изменении данных в ViewModel. Возможные состояния (загрузка, ошибка, данные, пустое состояние) моделируются с помощью `sealed interface`.

### Навигация
Навигация в приложении реализована с помощью **Jetpack Navigation for Compose**. В файле `ui/AppNavigation.kt` определен `NavHost` с графом навигации. Маршруты и аргументы (такие как `attemptId`) объявлены в объекте `AppDestinations` для типобезопасности и централизации. Переход между экранами и передача данных осуществляется через `NavController`.

---

## Сборка и запуск

1.  Клонируйте репозиторий:
    ```bash
    git clone git@github.com:heathlisss/DailyQuiz.git
    ```
2.  Откройте проект в Android Studio (последняя стабильная версия).
3.  Дождитесь завершения синхронизации Gradle. Зависимости будут скачаны автоматически.
4.  Соберите и запустите приложение на эмуляторе или физическом устройстве (минимальная версия SDK: 24).
